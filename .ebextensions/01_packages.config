# .ebextensions/01_packages.config

commands:
  01_add_fedora_repo:
    # Adds Fedora 36 repo for AL2023 compatibility
    command: |
      cat <<EOF > /etc/yum.repos.d/fedora.repo
      [fedora]
      name=Fedora 36 - \$basearch
      metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-36&arch=\$basearch
      enabled=0
      gpgcheck=1
      gpgkey=https://getfedora.org/static/fedora.gpg
      skip_if_unavailable=False
      EOF
  02_import_gpg_key:
    # Explicitly import the GPG key to prevent "untrusted package" errors during build
    command: "rpm --import https://getfedora.org/static/fedora.gpg"
  03_install_tesseract:
    # Install with --nogpgcheck as a final fallback for the build engine
    command: "dnf --enablerepo=fedora install -y tesseract tesseract-devel tesseract-langpack-eng --nogpgcheck"

packages:
  yum:
    gcc: []
    gcc-c++: []
    python3-devel: []
    poppler-utils: []
    mesa-libGL: []
    libSM: []
    libXrender: []
    libXext: []